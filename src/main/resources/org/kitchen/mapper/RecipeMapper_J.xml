<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.rog//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.kitchen.mapper.RecipeMapper_J">

	<resultMap id="recipe" type="org.kitchen.domain.RecipeVO">
		<result property="rno" column="r_num" />
		<result property="title" column="title" />
		<result property="thumbnail" column="thumbnail" />
		<result property="regdate" column="regdate" />
		<result property="updateDate" column="updatedate" />
		<result property="cookingTime" column="cookingtime" />
		<result property="difficulty" column="difficulty" />
		<result property="userNo" column="u_num" />
		<result property="categoryNo" column="c_code" />
	</resultMap>

	<select id="getList" resultMap="recipe">
<![CDATA[select * from tbl_recipe where r_num>0]]>
	</select>

	<insert id="insert">
		INSERT INTO tbl_recipe(r_num, cookingTime, difficulty, u_num, thumbnail, title, c_code)
		VALUES (r_seq.nextval, #{cookingTime}, #{difficulty}, #{userNo}, #{thumbnail}, #{title}, #{categoryNo})
	</insert>

<!-- 	<insert id="insertSelectkey">
		<selectKey keyProperty="rno" order="BEFORE"
			resultType="long">
			SELECT r_seq.nextval AND , u FROM tbl_recipe
		</selectKey>
		INSERT INTO tbl_recipe(r_num, cookingTime, difficulty, u_num, thumbnail, title, c_code)
		VALUES (#{rno}, #{cookingTime}, #{difficulty}, #{userNo}, #{thumbnail}, #{title}, #{categoryNo})
	</insert>  -->
	
	<select id="read" resultMap="recipe">
	SELECT * FROM tbl_recipe WHERE r_num = #{rno}
	</select>
	
	<delete id="deleteContent" >
	DELETE FROM tbl_recipecontent WHERE r_num = #{rno}
	</delete>
	
	<delete id="deleteMaterial" >
	DELETE FROM tbl_recipematerial WHERE r_num = #{rno}
	</delete>
	
	<delete id="deleteReview" >
	DELETE FROM tbl_recipereview WHERE r_num = #{rno}
	</delete>
	
	<delete id="deleteTag" >
	DELETE FROM tbl_recipetag WHERE r_num = #{rno}
	</delete>
	
	<delete id="deletewishRe" >
	DELETE FROM tbl_wishrecipe WHERE r_num = #{rno}
	</delete>
	
	<delete id="deleteRecipe" >
	DELETE FROM tbl_recipe WHERE r_num = #{rno}
	</delete>
	
	<update id ="update">
	UPDATE tbl_recipe
	SET
	title = #{title},
	thumbnail = #{thumbnail},
	regdate = #{regdate},
	updatedate = sysdate,
	cookingtime = #{cookingTime},
	difficulty = #{difficulty},
	u_num = #{userNo},
	c_code = #{categoryNo}
	WHERE r_num = #{rno}
	</update>

</mapper>
